<ion-header class="ion-no-border">
  <ion-item lines="none" color="primary">
    <ion-button style="margin-inline-end: 5px;" fill="clear" color="light" slot="start" (click)="closeModal()">
      <ion-icon name="arrow-back-outline" slot="icon-only"></ion-icon>
    </ion-button>
    <ion-avatar slot="start">
      <ion-img [src]="chat.image" *ngIf="chat.image" [class.hidden]="!cargo" (ionImgDidLoad)="cargo = !cargo" class="animate__animated animate__fadeIn"></ion-img>
      <ion-skeleton-text *ngIf="!cargo && chat.image" animated></ion-skeleton-text>
      <img src="../../assets/images/user.png" *ngIf="!chat.image">
    </ion-avatar>
    <ion-label color="light">
      <h3><b>{{chat.name}}</b></h3>      
    </ion-label>
  </ion-item>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)" mode="ios">
    <ion-refresher-content
    refreshingText="Cargando Mensajes..."></ion-refresher-content>
  </ion-refresher>
  <ion-grid>
    <ion-row *ngFor="let mensaje of chat.messages">
      <ion-col size="9" *ngIf="usuario.id !== mensaje.user_id" class="mensaje otro-mensaje">
        <span>{{mensaje.content}}</span>
        <div class="time ion-text-right">
          <br>
          {{mensaje.updated_at | date:'dd/MM/yyyy, hh:mm aa'}}
        </div>
      </ion-col>

      <ion-col offset="3" size="9" *ngIf="usuario.id === mensaje.user_id" class="mensaje mi-mensaje">
        <span>{{mensaje.content}}</span>
        <div class="time ion-text-right">
          <br>
          {{mensaje.updated_at | date:'dd/MM/yyyy, hh:mm aa'}}
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>



<ion-footer>
  <ion-toolbar>
    <div *ngIf="files.length > 0" style="display: flex;">
      <div *ngFor="let file of files" style="margin-right: 10px; position: relative;">
        <div *ngIf="file.type == 'img'" class="ion-text-center">
          <img style="width: 70px; height: 70px;" src="{{file.resPath}}" alt="">
          <ion-button size="small" class="delete-button" style="top: -5px; right: -10px;" color="dark">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </div>
        <div *ngIf="file.type == 'pdf'" class="ion-text-center">
          <img style="width: 50px; height: 70px;" src="../../assets/icon/pdf.png" alt="">
          <p style="margin: 0;">{{file.name}}</p>
          <ion-button size="small" class="delete-button" style="top: -5px; right: 10px;" color="dark">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>
    <ion-buttons slot="start">
      <ion-button expand="block" fill="clear" color="medium" class="mensaje-button" (click)="selectFile()">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-textarea [(ngModel)]="nuevoMensaje" placeholder="Escribe un mensaje..." rows="2" class="mensaje-input">
    </ion-textarea>
    <ion-buttons slot="end">
      <ion-button expand="block" fill="clear" color="medium" class="mensaje-button" (click)="enviarMensaje()">
        <ion-icon name="send" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>